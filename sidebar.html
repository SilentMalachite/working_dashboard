<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
      margin: 0;
      padding: 15px;
      background-color: #f5f5f5;
    }
    
    h3 {
      margin-top: 0;
      color: #333;
    }
    
    .section {
      background: white;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    button {
      width: 100%;
      padding: 12px;
      margin: 5px 0;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: bold;
      transition: background-color 0.3s;
    }
    
    button:hover {
      background-color: #0056b3;
    }
    
    button.danger {
      background-color: #dc3545;
    }
    
    button.danger:hover {
      background-color: #c82333;
    }
    
    button.secondary {
      background-color: #6c757d;
    }
    
    button.secondary:hover {
      background-color: #5a6268;
    }
    
    input[type="text"], input[type="color"] {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    
    .instructions {
      font-size: 12px;
      color: #666;
      margin-top: 10px;
      padding: 10px;
      background-color: #f0f8ff;
      border-radius: 4px;
      border-left: 3px solid #007bff;
    }
    
    .color-group {
      display: flex;
      gap: 10px;
      align-items: center;
      margin: 10px 0;
    }
    
    .color-group label {
      flex: 1;
      font-size: 13px;
    }
    
    .color-group input[type="color"] {
      width: 50px;
      height: 35px;
      padding: 2px;
    }
  </style>
</head>
<body>
  <div class="section">
    <h3>ğŸ“‹ ä½œæ¥­é …ç›®ã®æ“ä½œ</h3>
    <button onclick="addNewWorkItem()">ä½œæ¥­é …ç›®ã‚’è¿½åŠ </button>
    <button class="danger" onclick="clearAllWorkItems()">ä½œæ¥­é …ç›®ã‚’å…¨æ¶ˆå»</button>
  </div>
  
  <div class="section">
    <h3>ğŸ‘¤ åæœ­ã®æ“ä½œ</h3>
    <button onclick="addNewNameTag()">åæœ­ã‚’è¿½åŠ </button>
    <button class="secondary" onclick="resetAllNameTags()">é…ç½®ãƒªã‚»ãƒƒãƒˆ</button>
  </div>
  
  <div class="section">
    <h3>ğŸ¨ è‰²ã®è¨­å®š</h3>
    <div class="color-group">
      <label>é¸æŠã‚»ãƒ«ã®è‰²:</label>
      <input type="color" id="cellColor" value="#e0e0e0">
    </div>
    <button onclick="applyColor()">è‰²ã‚’é©ç”¨</button>
  </div>
  
  <div class="section">
    <h3>â„¹ï¸ ä½¿ã„æ–¹</h3>
    <div class="instructions">
      <strong>åæœ­ã®ç§»å‹•:</strong><br>
      åæœ­ã‚’ã‚³ãƒ”ãƒ¼(Ctrl+C/Cmd+C)ã—ã¦ã€ç›®çš„ã®ã‚»ãƒ«ã«è²¼ã‚Šä»˜ã‘(Ctrl+V/Cmd+V)ã—ã¦ãã ã•ã„ã€‚<br><br>
      
      <strong>åæœ­ã®ç·¨é›†:</strong><br>
      ã‚»ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦åå‰ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚<br><br>
      
      <strong>ä½œæ¥­é …ç›®ã®ç·¨é›†:</strong><br>
      Aåˆ—ã®ã‚»ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä½œæ¥­é …ç›®åã‚’å¤‰æ›´ã§ãã¾ã™ã€‚<br><br>
      
      <strong>ã‚¹ãƒ†ãƒ¼ã‚¸:</strong><br>
      â€¢ Cåˆ—: ä¸€æ¬¡ä½œæ¥­<br>
      â€¢ Eåˆ—: ãƒ€ãƒ–ãƒ«ãƒã‚§ãƒƒã‚¯<br>
      â€¢ Gåˆ—: æœ€çµ‚ç¢ºèª
    </div>
  </div>
  
  <script>
    // ä½œæ¥­é …ç›®ã‚’è¿½åŠ 
    function addNewWorkItem() {
      const title = prompt('ä½œæ¥­é …ç›®åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
      if (title) {
        google.script.run
          .withSuccessHandler(() => alert('ä½œæ¥­é …ç›®ã€Œ' + title + 'ã€ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼'))
          .withFailureHandler((error) => alert('ã‚¨ãƒ©ãƒ¼: ' + error))
          .addWorkItem(title);
      }
    }
    
    // ä½œæ¥­é …ç›®ã‚’å…¨æ¶ˆå»
    function clearAllWorkItems() {
      if (confirm('ã™ã¹ã¦ã®ä½œæ¥­é …ç›®ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nï¼ˆåæœ­ã¯åæœ­ãƒ—ãƒ¼ãƒ«ã«æˆ»ã‚Šã¾ã™ï¼‰')) {
        google.script.run
          .withSuccessHandler(() => alert('ä½œæ¥­é …ç›®ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼'))
          .withFailureHandler((error) => alert('ã‚¨ãƒ©ãƒ¼: ' + error))
          .resetWorkItems();
      }
    }
    
    // åæœ­ã‚’è¿½åŠ 
    function addNewNameTag() {
      const name = prompt('åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
      if (name) {
        google.script.run
          .withSuccessHandler(() => alert('åæœ­ã€Œ' + name + 'ã€ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼'))
          .withFailureHandler((error) => alert('ã‚¨ãƒ©ãƒ¼: ' + error))
          .addNameTag(name);
      }
    }
    
    // åæœ­ã‚’ãƒªã‚»ãƒƒãƒˆ
    function resetAllNameTags() {
      if (confirm('ã™ã¹ã¦ã®åæœ­ã‚’åæœ­ãƒ—ãƒ¼ãƒ«ã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ')) {
        google.script.run
          .withSuccessHandler(() => alert('åæœ­ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸï¼'))
          .withFailureHandler((error) => alert('ã‚¨ãƒ©ãƒ¼: ' + error))
          .resetNameTags();
      }
    }
    
    // è‰²ã‚’é©ç”¨
    function applyColor() {
      const color = document.getElementById('cellColor').value;
      const cell = prompt('ã‚»ãƒ«ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ (ä¾‹: B3, C5):');
      
      if (cell) {
        google.script.run
          .withSuccessHandler(() => alert('è‰²ã‚’é©ç”¨ã—ã¾ã—ãŸï¼'))
          .withFailureHandler((error) => alert('ã‚¨ãƒ©ãƒ¼: ' + error))
          .changeCellColor(cell, color);
      }
    }
  </script>
</body>
</html>
