# 作業ダッシュボード - Googleスプレッドシート版

dashboard.htmlと同様の機能をGoogleスプレッドシートで実現するための設定手順です。

## 📋 機能一覧

dashboard.htmlと同等の以下の機能を実装しています:

- ✅ **名札の管理**: 名札の追加、編集、色のカスタマイズ
- ✅ **作業項目の管理**: 作業項目の追加、編集、並び替え
- ✅ **3段階のステージ**: 一次作業 → ダブルチェック → 最終確認
- ✅ **名札の割り当て**: 名札を各作業ステージに移動(コピー&ペースト)
- ✅ **名札プール**: すべての名札を管理する中央エリア
- ✅ **リセット機能**: 名札の配置リセット、作業項目の全消去
- ✅ **色によるグループ化**: 名札や作業項目を色で区別

## 🚀 設定手順

### 1. Googleスプレッドシートを作成

1. [Google Sheets](https://sheets.google.com/)にアクセス
2. 新しいスプレッドシートを作成

### 2. Apps Scriptを設定

1. スプレッドシートで **拡張機能** → **Apps Script** をクリック
2. 表示されたエディタで、デフォルトのコード(`function myFunction() {}`)を削除
3. `gas_dashboard.gs` の内容を全てコピーしてペースト
4. **ファイル** → **保存** (またはCtrl+S / Cmd+S)
5. プロジェクト名を「作業ダッシュボード」などに変更

### 3. サイドバーHTMLを追加

1. Apps Scriptエディタで **+** ボタン → **HTML** をクリック
2. ファイル名を `sidebar` に変更
3. `sidebar.html` の内容を全てコピーしてペースト
4. **保存**

### 4. 初回実行と権限の承認

1. Apps Scriptエディタで、関数のドロップダウンから `onOpen` を選択
2. **実行** ボタンをクリック
3. 初回実行時、権限の確認が表示されます:
   - **権限を確認** → **詳細** → **〜に移動(安全でないページに移動)** → **許可**
4. スプレッドシートに戻り、ページを再読み込み

### 5. ダッシュボードを初期化

1. スプレッドシートに **「ダッシュボード」** メニューが表示されます
2. **ダッシュボード** → **初期化** をクリック
3. ダッシュボードが自動的に設定されます

## 📖 使い方

### メニュー操作

スプレッドシート上部の **「ダッシュボード」** メニューから以下の操作が可能です:

- **初期化**: ダッシュボードのレイアウトを初期化
- **名札を追加**: 新しい名札を名札プールに追加
- **作業項目を追加**: 新しい作業項目行を追加
- **名札を配置リセット**: すべての名札を名札プールに戻す
- **作業項目を全消去**: すべての作業項目を削除(名札は自動的にプールに戻る)
- **サイドバーを開く**: 操作用サイドバーを表示

### サイドバー操作

サイドバーから以下の操作が可能です:

- 作業項目の追加・削除
- 名札の追加・配置リセット
- セルの色変更
- 使い方の確認

### 名札の移動方法

dashboard.htmlではドラッグ&ドロップでしたが、スプレッドシート版では **コピー&ペースト** を使用します:

1. 移動したい名札のセルを選択
2. **Ctrl+C** (Mac: **Cmd+C**) でコピー
3. 目的のステージのセルをクリック
4. **Ctrl+V** (Mac: **Cmd+V**) で貼り付け
5. 元のセルの内容を削除(必要に応じて)

### 編集方法

- **名札の名前を変更**: セルをダブルクリックして編集
- **作業項目名を変更**: A列のセルをダブルクリックして編集
- **色を変更**: 
  - セルを選択して通常のスプレッドシート機能で色を変更
  - またはサイドバーの「色の設定」から変更

## 🎨 レイアウト構成

| 列 | 用途 |
|----|------|
| A列 | 作業項目名 |
| B列 | 名札プール |
| C列 | 一次作業 (青背景) |
| D列 | 矢印 (→) |
| E列 | ダブルチェック (オレンジ背景) |
| F列 | 矢印 (→) |
| G列 | 最終確認 (緑背景) |

## ⚠️ dashboard.htmlとの違い

### 同じ機能
- ✅ 名札の管理と割り当て
- ✅ 作業項目の管理
- ✅ 3段階のステージ
- ✅ リセット機能
- ✅ 色によるカスタマイズ

### 異なる点
- ❌ **ドラッグ&ドロップ**: スプレッドシートの制約により不可 → コピー&ペーストで代替
- ❌ **LocalStorage自動保存**: スプレッドシート自体が保存されるため不要
- ✅ **共同編集**: 複数人で同時編集可能(HTMLにはない機能)
- ✅ **クラウド保存**: 自動的にGoogleドライブに保存

## 💡 ヒント

1. **共同作業**: スプレッドシートを共有すれば、チームで同時に作業可能
2. **履歴管理**: ファイル → 変更履歴 で過去の状態を確認・復元可能
3. **印刷**: 通常のスプレッドシートとして印刷可能
4. **エクスポート**: Excel形式などにエクスポート可能

## 🔧 カスタマイズ

`gas_dashboard.gs` ファイルの以下の定数を変更することでカスタマイズできます:

```javascript
const SHEET_NAME = '作業ダッシュボード';  // シート名
const NAME_TAG_POOL_COL = 'B';           // 名札プールの列
const WORK_ITEMS_START_ROW = 3;          // 作業項目の開始行
```

色やレイアウトも `initializeDashboard()` 関数内で変更可能です。

## 📞 サポート

問題が発生した場合:

1. ブラウザのキャッシュをクリアして再読み込み
2. Apps Scriptエディタでエラーログを確認(**実行ログ**を表示)
3. 権限が正しく設定されているか確認
4. スプレッドシートを再読み込みして「ダッシュボード」メニューが表示されるか確認
